-- Function extensionality
id1 : T -> T
id1 := \a. a

id2 : T -> T
id2 := \b. b

id1PointwiseEqualsId2 : (a : T) -> id1 a = id2 a
id1PointwiseEqualsId2 := \c. refl[c]

#check funext(id1PointwiseEqualsId2)

homotopic : {A : U} -> {B : U} -> (f : A -> B) -> (g : A -> B) -> U
homotopic := \f. \g. (a : A) -> f a = g a

#check homotopic id1 id2

dhomotopic : {A : U} -> {P : A -> U} -> (f : (a : A) -> P a) -> (g : (a : A) -> P a) -> U
dhomotopic := \f. \g. (a : A) -> f a = g a

homotopyRefl : {A : U} -> {P : A -> U} -> (f : (a : A) -> P a) -> dhomotopic f f
homotopyRefl := \f. \(a : A). refl[f a]

#check homotopyRefl

homotopySymm : {A : U} -> {P : A -> U} -> (f : (a : A) -> P a) -> (g : (a : A) -> P a) -> dhomotopic f g -> dhomotopic g f
homotopySymm := \f. \g. \hfg. \(a : A). idSymm (hfg a)

#check homotopySymm

homotopyTrans : {A : U} -> {P : A -> U} -> (f : (a : A) -> P a) -> (g : (a : A) -> P a) -> (h : (a : A) -> P a) -> dhomotopic f g -> dhomotopic g h -> dhomotopic f h
homotopyTrans := \f. \g. \h. \hfg. \hgh. \(a : A). idTrans (hfg a) (hgh a)

#check homotopyTrans
